* ViewModel - 为 view 提供提供数据，并提供了一个 clear 的 API
* ViewModelProvider - 产生 ViewModel。构造时，需要传入一个 ViewModelStoreOwner
  * Factory：使用工厂方法产生 ViewModel。我们在获取 ViewModel 实例时，通常只是传递一个 ViewModel 的 class，然后 Factory 通过反射来生成实例。如果 ViewModel 需要额外的参数，则需要提供自定义的 Factory 来创建。
* ViewModelStoreOwner - 提供 ViewModel 存储数据结构 ViewModelStore
* ViewModelStore - 存储 ViewModel，内部实现使用的数据结构是 `HashMap<String, ViewModel>`



疑问：

* Activity 如何在重建时保留 ViewModel？

  在 `Activity#onRetainNonConfigurationInstance()` 中保存 ViewModelStore，恢复时通过调用 `Activity#getLastNonConfigurationInstance()`。

  > onRetainNonConfigurationInstance() 可以保留更广泛的数据，而 onSaveInstanceState(Bundle) 只能保留 Bundle 支持的数据。

* ViewModel 的 clear 在什么时候发生？

  Activity 是一个生命周期对象，它提供了一个 Lifecycle 对象。在 Activity 创建时，会添加了一个 LifecycleEventObserver，当 observer 接收到 `ON_DESTROY` 事件时，调用 ViewModelStore 的 `clear()` 方法。

  > 由此可见，ViewModel 的清理是与 ViewModelStore 绑定的，拥有 ViewModelStore 的生命周期对象需要主动处理 ViewModelStore 的生命周期。