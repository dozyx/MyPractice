> 关于权限的实践还比较缺乏，下面内容可能存在不足

权限需要在清单文件中声明，Android 从 6.0 加入运行时权限：

+ [普通权限](https://developer.android.com/guide/topics/permissions/normal-permissions.html)：在安装时系统授予
+ 危险权限：需要应用在运行时向用户请求授予

> Android 6.0 之前，权限在安装时进行授予，一旦拒绝后，将无法获得

### 运行时权限

运行时权限的处理主要涉及几个方法：

+ `ContextCompat.checkSelfPermission` - 检查应用是否已获得某个权限


+ `ActivityCompat.shouldShowRequestPermissionRationale` - 判断是否需要向用户进行说明，该方法的返回结果包括以下三种情况：
  + 第一次请求权限时，如果用户拒绝了，再次请求时返回true
  + 多次请求权限（超过一次），用户如果选择了不再询问并拒绝，返回false
  + 设备的策略禁止当前应用获取这个权限的授权，返回false
+ `ActivityCompat.requestPermissions`
+ `Activity#onRequestPermissionsResult`：请求权限结果回调

请求时对单个权限进行请求，但用户允许后将获得整个权限组的权限，并且下次不再需要询问。

示例代码：

```java
// Here, thisActivity is the current activity
if (ContextCompat.checkSelfPermission(thisActivity,
                Manifest.permission.READ_CONTACTS)
        != PackageManager.PERMISSION_GRANTED) {

    // Should we show an explanation?
    if (ActivityCompat.shouldShowRequestPermissionRationale(thisActivity,
            Manifest.permission.READ_CONTACTS)) {

        // Show an expanation to the user *asynchronously* -- don't block
        // this thread waiting for the user's response! After the user
        // sees the explanation, try again to request the permission.

    } else {

        // No explanation needed, we can request the permission.

        ActivityCompat.requestPermissions(thisActivity,
                new String[]{Manifest.permission.READ_CONTACTS},
                MY_PERMISSIONS_REQUEST_READ_CONTACTS);

        // MY_PERMISSIONS_REQUEST_READ_CONTACTS is an
        // app-defined int constant. The callback method gets the
        // result of the request.
    }
}
```

```java
@Override
public void onRequestPermissionsResult(int requestCode,
        String permissions[], int[] grantResults) {
    switch (requestCode) {
        case MY_PERMISSIONS_REQUEST_READ_CONTACTS: {
            // If request is cancelled, the result arrays are empty.
            if (grantResults.length > 0
                && grantResults[0] == PackageManager.PERMISSION_GRANTED) {

                // permission was granted, yay! Do the
                // contacts-related task you need to do.

            } else {

                // permission denied, boo! Disable the
                // functionality that depends on this permission.
            }
            return;
        }

        // other 'case' lines to check for other
        // permissions this app might request
    }
}
```

### PermissionsDispatcher 源码分析

[github地址](http://www.10tiao.com/html/227/201610/2650237473/1.html)

（待）









参考：    

[Requesting Permissions](https://developer.android.com/guide/topics/permissions/requesting.html)

[Android 6.0运行时权限详解](http://www.10tiao.com/html/227/201610/2650237473/1.html)

[android各大手机系统打开权限管理页面](http://blog.csdn.net/vinomvp/article/details/52228377)